# 2021년 9월 9일 [81일차]

## # 오전수업
----
### `09:30~`

single 정렬. 진도 예정.    

Sort 는 필수기능.  

#

### # Single Sort 기능 구현.  

`boardList2.jsp` 에서 시작.   

`등록일` `<th>` 태그에,  

`<span>`태그로 끌어안고,  

클래스값, 클릭모양 변경 주기,  

```jsp
<th>번호</th><th>제목</th><th>작성자</th><th>조회수</th><th><span class="reg_date" style="cursor: pointer;">등록일</span></th></tr>
```
> `<span>` 안에서 클릭 활성화 안해주고,  

> `$(".reg_date").css("cursor", "pointer");` `.ready()` 아래에 작성해주어도 같은 기능이다.   

#

`<span>` 의 style 은 지워주고 `.ready()` 아래에 코드 작성해주기.  

```javascript
// *****************************************
// body 태그 안의 내용을 모두 읽어들인 이후 실행할 자스 코드 설정하기  
// *****************************************
$(document).ready(function(){

    changeBgColor(); //common.jsp 파일에서 수입하는 함수.


    $(".reg_date").css("cursor", "pointer");
    // --------------------------------------------
    $(".reg_date").click(function(){

        // alert("등록일 정렬 클릭 테스트 확인!");

        var obj = $(this); 
        var text = obj.text();  
        text = $.trim(text); 


        if( text.indexOf("▲")>=0 ){
            $(".sort").val(""); // 쿼리 일부가 들어감.  

        }
        else if( text.indexOf("▼")>=0 ){
            $(".sort").val("reg_date asc"); // 쿼리 일부가 들어감.  


        }
        else{
            // alert("else 에 걸림.")
            $(".sort").val("reg_date desc"); // 쿼리 일부가 들어감.  
            // obj.append("▼")

        }
    });
    // --------------------------------------------

});
```
> `indexOf()` 연산자와 쓰여서 데이터가 있나 없나 확인 가능.  

> `내림차순` 이면 최신의 날짜가 나와야 한다.
> `오름차순` 이면 오래된 날짜가 나와야 한다.  
> `쿼리`를 `val 값`에 담아서 날리면 된다.  



`boardListForm` 폼태그 안에 히든태그가 있어야 한다.  
```jsp
<input type="hidden" name="sort" class="sort" value="">
```
> 등록일 정렬 기준이 들어가야한다.  

#

----
### `10:30~`

`BoardSearchDTO.java` 에서,      

아래 코드 추가하고,   

```java
private String sort;   
```
> `getter` `setter`  설정 해주기.    

#

`mapper_board.xml` 에서,  

`getBoardList` 부분 쿼리,  

```xml
order by 
    <if test="sort==null or sort.length()==0">
        group_no desc
        ,print_no asc
    </if>
    <if test="sort!=null and sort.length()>0">
        #{sort}
    </if>
```
> `#{}` 이면 양쪽에 싱글쿼트를 붙여서 나오게 한다.   
> 그러므로, `${}` 이 맞다.  

#

여기까지 하면 한번만 작동하고 작동이 안된다.     

비동기 방식으로 HTML 소스로 다시 덮어 씌웠기 때문.    

HTML 소스에는 이벤트가 걸려있지 않아서.   

`boardList2.jsp` 에서,    

```javascript
// *****************************************
// body 태그 안의 내용을 모두 읽어들인 이후 실행할 자스 코드 설정하기  
// *****************************************
$(document).ready(function(){

    changeBgColor(); //common.jsp 파일에서 수입하는 함수.

    // --------------------------------------------
    xxx();
    // --------------------------------------------

});

function xxx(){

  $(".reg_date").css("cursor", "pointer");
  
  $(".reg_date").click(function(){

        // alert("등록일 정렬 클릭 테스트 확인!");

        var obj = $(this); 
        var text = obj.text();  
        text = $.trim(text); 


        if( text.indexOf("▲")>=0 ){
            $(".sort").val(""); // 쿼리 일부가 들어감.  

        }
        else if( text.indexOf("▼")>=0 ){
            $(".sort").val("reg_date asc"); // 쿼리 일부가 들어감.  


        }
        else{
            // alert("else 에 걸림.")
            $(".sort").val("reg_date desc"); // 쿼리 일부가 들어감.  
            // obj.append("▼")

        }

        search();
    });
}
```
> 함수로 따로 빼고 호출해야 한다.    
> 함수로 호출 시키는 이유는,  
> 반복적으로 호출하기 위함.  

> 그 후, `ajax` 의 `success` 부분에 `xxx();` 함수를 추가한다.  

> `xxx();` 함수 이름을 `reg_date_sort()` 로 바꾸어 주기.  

#

여기까지 하면 클릭할때 `▲▼` 가 보이지 않는다.  

보이게 하기 위해서.   

`ajax` 부분의,   

`success`에서,  
`reg_date_sort();` 함수 아래에,  

추가 코딩 해야한다.    

```javascript
  reg_date_sort();
  var sort = $(".sort").val();
  if(sort=="reg_date asc"){
      $(".reg_date").append("▲");
  }
  else if(sort=="reg_date desc"){
      $(".reg_date").append("▼");
  }
  else{
      $(".reg_date").append("");
  }
```

#

----
### `11:30~`








----
### `12:30~`








----
### `13:20~`

  - 점심시간.

---
---

## # 오후수업

---
### `14:30~`










---
### `15:30~`









----
### `16:30~`








----
### `17:30~`








----
### `18:30~`
