# 2021년 9월 13일 [83일차]

## # 오전수업
----
### `09:30~`

<이번주 목표>   

파일 업로드 기능 구현.    

게시판 관련 문제 풀면서 복습.    

#

<파일 업로드>   

게시판 입력 수정.   

DB 저장,  

파일까지 업로드 되어야 한다.  

데이터베이스에 안들어가면,  

파일 업로드도 안되어야 한다.  

즉, 파일 업로드하고 DB 연동이 같이 움직여야 한다.   

#

오후부터는 게시판 소스 중심 문제 정리.  

#

다음주는 리엑트 나갈 예정.   

#

<진도>  
<파일업로드>   

지금까지는,  
웹서버쪽으로 문자데이터를 DB에 넣은것이다.  

파일업로드는,  
파일을 서버로 올린다.  
서버로 올라간 파일이 특정폴더에 저장되어야 한다.  

올라간 파일의 이름은,  
규칙적이고 중복되지 않게 이름이 바뀌어서 저장되어야 한다.  

그 후,    
특정 폴더에 저장되어야 한다.  
그리고, DB쪽에 파일이름이 저장된다.  

#

SQL 게이트 열어서,  

이미지가 들어갈 컬럼 추가.   

컬럼명은 `PIC`  

데이터 유형 `varchar2`    

이미지는 선택사항,  제약조건 없이,   
> 이미지가 반드시 들어가야하면, 제약조건이 들어가야 한다.    

#

`boardRegForm.jsp` 에서,    

파일 업로드 버튼 및 기능 구현.     

상당부분 코드 변경 예정.   

이미지 입력양식 추가.  

```jsp
<form name="boardRegForm" method="POST" action="/boardRegProc.do" enctype="multipart/form-data">


<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

<!-- ====================================== -->
<!-- 위 코드도 추가해야 한다 -->
<!-- 하단 코드는 위치 확인용 -->
<!-- ====================================== -->

<tr>
    <th bgcolor="${thBgColor}">내용</th>
    <td>
    <textarea name="content" class="content" rows="13" cols="40"  maxlength="300"></textarea>
    </td>
</tr>

<!-- ====================================== -->
<!-- 위 쪽 코드는 위치 확인용. -->
<!-- 아래 코드를 추가한 것이다. -->
<!-- ====================================== -->

<tr>
    <th bgcolor="${thBgColor}">이미지</th>
    <td>
    <input type="file" name="img" class="img">
    </td>
</tr>
```
> 파일업로드 입력양식이 들어가면,  
> 상단의 form 태그 안에,  
> 반드시!! `enctype="multipart/form-data"` 코드가 추가되어야 한다.     

```javascript
function checkBoardRegForm(){
    // ------------------------------------
    // "정말 등록 하시겠습니까?" 라고 물어보기
    // ------------------------------------
    if(confirm("정말 등록 하시겠습니까??")==false) {return;}

// ===================================
// 위 코드는 위치 확인용.  
// 아래 코드를 추가해야함.  
// ===================================

    // ------------------------------------
    // form 태그에 파일업로드 전송 관련 설정하기
    // ------------------------------------
    document.boardRegForm.enctype="multipart/form-data";
```
> form 태그안에 `enctype="multipart/form-data"` 써주지 않고 작동하게 하려면,  
> 클릭 했을 시 작동하는 함수안에다가 위 코드를 넣어야 한다.   


현재 `ajax` 형식 에서는 파일업로드가 되지 않는다.    

`ajax` 의,  

`,data     : $("[name=boardRegForm]").serialize() ` 부분을 지우고 새로운 코드를 작성해야 한다.  

```javascript
$.ajax({

    // ----------------------------------------------------------
    // 서버쪽 호출 URL 주소 지정
    // ----------------------------------------------------------
    url       : "/boardRegProc.do"
    // ----------------------------------------------------------
    // form 태그 안의 입력양식 데이터 즉, 파라미터값을 보내는 방법 지정
    // ----------------------------------------------------------
    ,type     : "post"

// =====================================
// 위쪽코드는 위치 확인용.
// 아래 코드가 추가되었음.  
// =====================================
    
    // ----------------------------------------------------------
    // 파일업로드를 위한 설정.    
    // ----------------------------------------------------------
    ,processData    :    false
    ,contentType    :    false
    ,data           :    new FormData(  $("[name=boardRegForm").get(0)  )


    // 아래코드는 입력양식의 name 값과 value 값만 보내지는것. 위쪽 코드는 파일까지 되는 코드.   
    // ,data     : $("[name=boardRegForm]").serialize()
```
> 원본 파일에서 주석도 붙여주면 좋다.  

#

시중의 책에는 파일업로드 방식이 두가지가 있다.   

그중 하나가 `ajax` 이용한 업로드 방식.   

#

----
### `10:30~`








----
### `11:30~`








----
### `12:30~`








----
### `13:20~`

  - 점심시간.

---
---

## # 오후수업

---
### `14:30~`










---
### `15:30~`









----
### `16:30~`








----
### `17:30~`








----
### `18:30~`
