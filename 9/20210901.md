# 2021년 9월 1일 [76일차]

## # 오전수업
----
### `09:30~`

#

<복습>  

어제는 미완성 페이징 처리,  

`BoardSearchDTO` 에서,    

디폴트 선택페이지 번호 `selectPageNo` 는 `1`  

로그인 할때 시작할때 선택되어지도록 정해준것.  

한 화면에 보여지는 행의 개수 `rowCntPerPage` 는 `10행`   

#

<예정 진도>  

내가 원하는 페이지 번호 클릭해서,       

페이지 번호 가져오는 작업,         

완성할 예정.       

페이지 하단에 페이지번호 출력,    

클릭하면 그 페이지 열어주는 작업.     

#

`BoardController` 에서,   

`"/boardList.do"` 부분,  

마지막 페이지 번호.  

```java
/* 페이지 번호 사용할 예정
    if( totCnt > 0 ){
        int last_pageNo = totCnt/rowCntPerPage;
            if( totCnt%rowCntPerPage > 0 ){last_pageNo++;}

        int min_pageNo = (selectPageNo - 1)/pageNoCntPerPage * pageNoCntPerPage + 1;
        int max_pageNo = min_pageNo + pageNoCntPerPage - 1;
            if( max_pageNo > last_pageNo ) { max_pageNo = last_pageNo; }
    }
*/

// 위 코드를 사용해서 계산 한다.  
// 작성하는 코드는 아님, 로직 분석만.  


  System.out.println("컨트롤러 /boardList.do 진행... ");
  // 콘솔 확인 코드 밑에 작성.  

  int last_pageNo = 0;
  int min_pageNo = 0;
  int max_pageNo = 0;

  if( getBoardListCount > 0 ){

      int selectPageNo = boardSearchDTO.getSelectPageNo();
      int rowCntPerPage = boardSearchDTO.getRowCntPerPage();
      int pageNoCntPerPage = 10;


      last_pageNo = getBoardListCount/rowCntPerPage;
          if( getBoardListCount%rowCntPerPage > 0 ){last_pageNo++;}
      min_pageNo = (selectPageNo - 1)/pageNoCntPerPage * pageNoCntPerPage + 1;
      max_pageNo = min_pageNo + pageNoCntPerPage - 1;
          if( max_pageNo > last_pageNo ) { max_pageNo = last_pageNo; }
  }

  mav.addObject("last_pageNo", last_pageNo);
  mav.addObject("min_pageNo", min_pageNo);
  mav.addObject("max_pageNo", max_pageNo);    
```
> 변수를 0으로 대입해서 선언해놓고 if문 주는것이 좋다.      

> `last_pageNo` 와 `max_pageNo` 는 보정작업 `if 문`이 들어간다.    

> 검색 화면에서 필요한 자바영역의 데이터,    
> `getBoardListCount`   
> `last_pageNo`  
> `min_pageNo`  
> `max_pageNo`  

#

`boardList.jsp` 에서,  

```html
  <!-- 페이지 번호 출력 -->

  <%=(Integer)request.getAttribute("last_pageNo")%> <br>
  <%=(Integer)request.getAttribute("min_pageNo")%> <br>
  <%=(Integer)request.getAttribute("max_pageNo")%> <br>
```
> 값이 올바르게 저장되는지 꺼내어 출력해봄.    
> 컨트롤러에서 `addObject()` 로 키값붙여 저장한 데이터는 `[ModelAndView 객체]`에 저장고, 이것을 꺼내려면 `Httpservletrequest` 객체 메소드 `getAttribute()` 를 사용하여 꺼낸다.  

#

----
### `10:30~`

`BoardController` 에서,  
전시간에 작성한 코드 정리 및 주석 처리.  

```java
  // ***************************************
  // 마자막 페이지 번호 구하기
  // 현 화면에 보여줄 최소 페이지 번호 구하기
  // 현 화면에 보여줄 최대 페이지 번호 구하기
  // ***************************************
  int last_pageNo = 0;
  int min_pageNo = 0;
  int max_pageNo = 0;

  int selectPageNo = boardSearchDTO.getSelectPageNo();
  int rowCntPerPage = boardSearchDTO.getRowCntPerPage();
  int pageNoCntPerPage = 10;

  if( getBoardListCount > 0 ){


      last_pageNo = getBoardListCount/rowCntPerPage;
          if( getBoardListCount%rowCntPerPage > 0 ){last_pageNo++;}
      min_pageNo = (selectPageNo - 1)/pageNoCntPerPage * pageNoCntPerPage + 1;
      max_pageNo = min_pageNo + pageNoCntPerPage - 1;
          if( max_pageNo > last_pageNo ) { max_pageNo = last_pageNo; }
  }

  // ***************************************
  // [ModelAndView 객체] 생성하기
  // ***************************************
  ModelAndView mav = new ModelAndView();
  // ***************************************
  // [ModelAndView 객체] 에 [호출 JSP 페이지명]을 저장하기
  // ***************************************
  mav.setViewName("boardList.jsp");

  // ***************************************
  // [ModelAndView 객체] 에 [게시판 목록 검색 결과]를 저장하기
  // [ModelAndView 객체] 에 [게시판 목록의 총개수]를 저장하기
  // [ModelAndView 객체] 에 [현재 화면에 보여지는 페이지 번호의 마지막 페이지 번호]를 저장하기
  // [ModelAndView 객체] 에 [현재 화면에 보여지는 페이지 번호의 최소 페이지 번호]를 저장하기
  // [ModelAndView 객체] 에 [현재 화면에 보여지는 페이지 번호의 최대 페이지 번호]를 저장하기
  // ***************************************
  mav.addObject("boardList", boardList);
  
  mav.addObject("getBoardListCount", getBoardListCount);
  
  mav.addObject("last_pageNo", last_pageNo);
  mav.addObject("min_pageNo", min_pageNo);
  mav.addObject("max_pageNo", max_pageNo);
  
    

  System.out.println("컨트롤러 /boardList.do 진행... ");
  
  // ***************************************
  // [ModelAndView 객체] 리턴하기
  // ***************************************
  return mav;
```
> 전시간 코드 보기 편하게 정리하고 주석달았음.  

#

페이지 관련된 데이터는 DB에 안들어서,    
`BoardController` 자바쪽에서 계산.    

#

스프링에서 DTO 쓰는이유,  
다량의 데이터, 쉽게 이동하기 위해,  
많은 양의 파라미터 값들을 쉽게 받기 위해.  

DTO 를 사용하여 쿼리쪽에서 많은 작업을 할 수 있다.  

#

`boardList.jsp` 에서,  

페이지 번호 출력 만들기,  

페이지 번호 클릭 했을 시 이벤트 만들기.  

```html

  <%=(Integer)request.getAttribute("last_pageNo")%> <br>
  <%=(Integer)request.getAttribute("min_pageNo")%> <br>
  <%=(Integer)request.getAttribute("max_pageNo")%> <br>
<!-- 위 테스트 출력 코드는 지워준다. -->




  <!-- 페이지 번호 출력 -->
  <div class="pageNo">

      <%
          int last_pageNo = (Integer)request.getAttribute("last_pageNo");
          int min_pageNo = (Integer)request.getAttribute("min_pageNo");
          int max_pageNo = (Integer)request.getAttribute("max_pageNo");
          int getBoardListCount = (Integer)request.getAttribute("getBoardListCount");
          
          if( getBoardListCount>0 ){
              for( int i = min_pageNo; i<=max_pageNo; i++ ){
                  out.print( "<span>" + i + "</span> " );
              }

          }

      %>

  </div>
```
> 코딩했던것 `div 태그`로 감싸주기.    
> `div 태그` 사용하는 이유, 그룹화 해서 묶어 주려고,      
> 그 후 자바 코드 추가 코딩.    
> 페이지 번호를 나열되는걸 볼수 있다.  

비동기 방식으로 달라진 페이지 번호를 반영해야 한다.

```javascript
  // ----------------------------------------------------------
  var pageNo = $(responseHTML).find(".pageNo").html();

  $(".pageNo").html(pageNo);
```

#

`BoardController` 에서,      

`"/boardList.do"` 쪽,    

`selectPageNo`, `rowCntPerPage`, `pageNoCntPerPage` 도 `addObject()` 로 저장.      

```java
  mav.addObject("selectPageNo", selectPageNo);
  mav.addObject("rowCntPerPage", rowCntPerPage);
  mav.addObject("pageNoCntPerPage", pageNoCntPerPage);  
```
> 선택한 페이지번호, 저장하고 꺼내려는 이유,  
> 보여지는 페이지가 몇페이지인지 표현하기 위해,  

#

`boardList.jsp` 에서,  

```html
<!-- 페이지 번호 출력 -->
<div class="pageNo">

    <%
        int last_pageNo = (Integer)request.getAttribute("last_pageNo");
        int min_pageNo = (Integer)request.getAttribute("min_pageNo");
        int max_pageNo = (Integer)request.getAttribute("max_pageNo");
        int getBoardListCount = (Integer)request.getAttribute("getBoardListCount");
        int selectPageNo = (Integer)request.getAttribute("selectPageNo");
        
        if( getBoardListCount>0 ){
            for( int i = min_pageNo; i<=max_pageNo; i++ ){
                if( i==selectPageNo ){
                    out.print( "<span>" + i + "</span> " );
                
                }else{
                    out.print( "<span>[" + i + "]</span> " );

                }
            }
        }

    %>

</div>
```
> `int selectPageNo = (Integer)request.getAttribute("selectPageNo");` 추가하고,  
> if문 안에 if문을 추가하여,  
> `selectPageNo` 와 같다면 `i` 출력,  
> 그외에는 `[i]` 출력되게 구현.  

#

----
### `11:30~`








----
### `12:30~`








----
### `13:20~`

  - 점심시간.

---
---

## # 오후수업

---
### `14:30~`










---
### `15:30~`









----
### `16:30~`








----
### `17:30~`








----
### `18:30~`
