# 2021년 8월 23일 [69일차]

## # 오전수업
----
### `09:30~`

<복습>

- `Spring MVC 패턴` [웹브라우저]와 [웹서버]의 통신 과정 암기하기.  

- @Service 와 @Transactional 어노테이션이 붙은 객체 안의 xxx2 메소드 생략한 이유?  
  > select 라서 트랜잭션이 필요하지 않아서.  
  > 트랜잭션 걸어줘도 상관은 없다.  (입) 

  > 트랜잭션이 필요할 때?  
  > 입력, 수정, 삭제 작업이 `2개 이상` 일때.   
  > 1개는 어차피 하나가 들어가고 안들어가고 이기 때문이다.  

  > 실무에서는 하나라도 입력, 수정, 삭제 작업이 있으면 트랜잭션 걸어주는것이 좋다.  


컨트롤러 객체(클래스)  

서비스 객체(클래스)  

DAO 객체(클래스)  

![컨트롤러_서비스_DAO](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210823%200944_%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC_%EC%84%9C%EB%B9%84%EC%8A%A4_DAO_.png)    
  
![컨트롤러_서비스_DAO_2](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210823%200944_%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC_%EC%84%9C%EB%B9%84%EC%8A%A4_DAO_2_.png)    
> 큰 프로젝트에서는 서비스층이 여러개 있을 수 있다.  


게시판 검색화면이 제일 난이도가 높다.      

오늘은 게시판 새글쓰기 DB연동.          
  
게시판 흐름 시나리오.        
 
새글과 댓글     
> 출력 순서번호. 생각해주어야 한다. 
> update, insert  => transaction 필요.  

#

속성변수 왼쪽에,     
자료형은 => `기본형`/`클래스형`/`인터페이스형`   

![자료형](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210823%201008_%EC%9E%90%EB%A3%8C%ED%98%95_.png)     
> 자료형이 인터페이스이면, 인터페이스를 구현한 객체의 메위주가 변수 a 에 들어간다.    
> 자료형이 클래스이면, xxx 클래스 메위주 혹은 xxx 클래스 후손객체 메위주도 변수 a 에 들어간다.    
    
> `@Autowired` 가 없으면 `null` 이 들어간다.  

> `@Autowired` 가 붙은 속성변수에는 무조건 객체의 메위주가 들어있다. 인터페이스일 경우 알아서 구현화된 객체를 찾아준다. (결합도 약화)
> `결합도약화` => 수정의 연쇄반응을 줄이거나 없앤다.  
> `속성변수의 쓰임새` => 동료 속성변수나 동료 메소드 공용으로 사용하기위해 속성변수에 집어넣는다.  

----
### `10:30~`

서비스 클래스 사용하여 트랜잭션 자동으로 걸리게 작업하는것까지 진도 예정.  

#

(입)  
```java 
@Autowired
private LoginDAO loginDAO;

// 대신에 아래처럼 해도 되지만 결합도가 올라가므로 위의 코딩처럼 하는것이 결합도약화를 할 수 있다.  

private LoginDAOImpl loginDAO; 
```

#

- 책 추천 

  [자바 이야기.](https://book.naver.com/bookdb/book_detail.nhn?bid=6030871)    

#

`loginForm.jsp` 이동해서,
ajax 부분 추가 코딩.  
```javascript
location.replace("/boardList.do")
```
> `loginForm.jsp` 는 웹서버에 있는것이고,     
> 클라이언트는 `loginForm.jsp` 실행되어, 이것들을 `html`로 응답받아서 보는것이다.  
> `html` 로 응답받아서 보기 때문에 jsp 문법은 보이지 않는다.  

#

`LoginController.java` 이동해서 추가 코딩.  

어노테이션은 매개변수에도 붙을 수 있다.  

```java  
// ********************************************
// 가상주소 /loginProc.do 로 접근하면 호출되는 메소드 선언
// ********************************************
@RequestMapping( value="/loginProc.do")
public ModelAndView loginProc( 
    // ---------------------------------------
    // "login_id" 라는 파라미터명에 해당하는 파라미터값을 꺼내서 매개변수 login_id 에 저장하고 들어온다.
    // ---------------------------------------
    @RequestParam( value="login_id" ) String login_id 
    // ---------------------------------------
    // "pwd" 라는 파라미터명에 해당하는 파라미터값을 꺼내서 매개변수 pwd 에 저장하고 들어온다.
    // ---------------------------------------
    ,@RequestParam( value="pwd" ) String pwd
){
    // --------------------------------------------------
    // HashMap 객체 생성하기
    // HashMap 객체에 로그인 아이디 저장하기
    // HashMap 객체에 암호 저장하기
    // --------------------------------------------------
    Map<String,String> map = new HashMap<String,String>();
    map.put("login_id", login_id);
    map.put("pwd", pwd);

    // --------------------------------------------------
    // loginDAOImpl 객체의 getLogin_idCnt 메소드를 호출하여 
    // 로그인 아이디와 암호의 전체 개수 얻기
    // --------------------------------------------------
    System.out.println("LoginController.loginProc => " + 2);
    System.out.println("LoginController.loginProc 해시맵 객체 => " + map);

    int login_idCnt = loginDAO.getLogin_idCnt(map);
    System.out.println("LoginController.loginProc => " + 3);
    System.out.println("LoginController.loginProc login_idCnt 보기 => " + login_idCnt);
    

    // System.out.println( "login_id => " + login_id ); // 입력된 아이디값 콘솔출력.
    // System.out.println( "pwd => " + pwd );           // 입력된 암호값 콘솔 출력.   


    // ---------------------------
    // [ModelAndView 객체] 생성하기.
    // [ModelAndView 객체] 에 [호출 JSP 페이지명]을 저장하기
    // [ModelAndView 객체] 에 아이디 암호 존재개수 저장하기. 즉, DB 연동 결과물 저장하기.
        // [ModelAndView 객체] 에 저장된 DB 연동 결과물은 
        // HttpServletRequest 객체에 setAttribute 메소드로 저장된다. 
    // [ModelAndView 객체] 리턴하기.
    // ---------------------------
    ModelAndView mav = new ModelAndView();
    mav.setViewName("loginProc.jsp");
    mav.addObject("idCnt", login_idCnt);      // DB 연동한 결과물이 1이라고 치고, 결과 보는것.  
        // 위 addObject 메소드로 저장된 DB 연동 결과물은 
        // HttpServletRequest 객체에 setAttribute 메소드로 저장된다.
    
    System.out.println("LoginController.loginProc 메소드 호출 완료!");

    return mav;
}
```
> 가상주소 /loginProc.do 로 접근하면 호출되는 메소드 다른방식으로 코딩. 
> 아래 수정전 코드와 비교해보기.   

> `loginProc()` 메서드 매개변수를 변경한 것이다.     
> `HttpServletRequest request` 매개변수 대신에 위의 코드들이 들어간 것이다. 

- 추가 변경된 코드부분.
  ```java 
    // ---------------------------------------
    // "login_id" 라는 파라미터명에 해당하는 파라미터값을 꺼내서 매개변수 login_id 에 저장하고 들어온다.
    // ---------------------------------------
    @RequestParam( value="login_id" ) String login_id 
    // ---------------------------------------
    // "pwd" 라는 파라미터명에 해당하는 파라미터값을 꺼내서 매개변수 pwd 에 저장하고 들어온다.
    // ---------------------------------------
    ,@RequestParam( value="pwd" ) String pwd
  ```
  > 파라미터명과 파라미터 값을 바로 매개변수로 받아오는 코딩이다.  

```java
// ********************************************
// 가상주소 /loginProc2.do 로 접근하면 호출되는 메소드 선언
// ********************************************
@RequestMapping( value="/loginProc2.do")
public ModelAndView loginProc2( 
    // 클라이언트가 보낸 요청 메시지를 관리하는 HttpServletRequest 객체가 매개변수로 들어온다.
    // HttpServletRequest 객체의 메소드를 이용하면 파라미터값을 얻을 수 있다.
    HttpServletRequest request
){
    System.out.println("LoginController.loginProc 메소드 호출 시작!");
    System.out.println("LoginController.loginProc => " + 1);
    // --------------------------------------------------
    // 클라이언트가 보낸 요청 메시지 안의 "id" 라는 파라미터명의 파라미터값 꺼내기
    // 클라이언트가 보낸 아이디를 꺼내라
    // 클라이언트가 보낸 요청 메시지 안의 "pwd" 라는 파라미터명의 파라미터값 꺼내기
    // 클라이언트가 보낸 암호를 꺼내라
    // --------------------------------------------------
    String login_id = request.getParameter("login_id");
    String pwd = request.getParameter("pwd");
    
    System.out.println("LoginController.loginProc => 파라미터명 login_id => " + login_id);
    System.out.println("LoginController.loginProc => 파라미터명 pwd => " + pwd);
```
> 이부분이 수정 전 내용이다. 위의 코딩과 비교하기.  

> `HttpServletRequest request` 매개변수로 받아서  
> `getParameter( )` 메서드 호출하는  
> `String login_id = request.getParameter("login_id");` 과,  

> 매개변수로 바로 받는   
> `@RequestParam( value="login_id" ) String login_id ` 차이이다.  

#

> 파라미터값을 받는 두가지 방법이였다.  

----
### `11:30~`

`/boardList.do` 연관 코딩.  

로그인에 관련된 URL 주소 관리하는곳이,  
`LoginController.java` 이다.   

업무상 로그인 관련만 모아두기 때문에,  

`/boardList.do`  는 게시판 관련 URL 관리 클래스를 만들어주어야 한다.   

`BoardController.java` 생성해주기.  


----
### `12:30~`








----
### `13:20~`

  - 점심시간.

---
---

## # 오후수업

---
### `14:30~`










---
### `15:30~`









----
### `16:30~`








----
### `17:30~`








----
### `18:30~`
