# 2021년 8월 31일 [75일차]

## # 오전수업
----
### `09:30~`

### # 검색 총 개수 표기하기.  

어제, 과제.  

정답 풀이.  

`BoardController.java`  에서,  

검색 결과물의 개수를 가져오기.  

```java
// ***************************************
// 검색 조건에 맞는 [게시판 목록의 총개수] 얻기
// ***************************************
int getBoardListCount = this.boardDAO.getBoardListCount( boardSearchDTO );
```
> 서비스층을 거치는 이유는 트랜잭션, DB연동 세세하게 하기 위해,  
> 여기서는 바로 DAO 쪽으로 이동,   

> `@Controller`     
> URL 주소 맞이,    

> `@Service`     
> DB연동의 세분화,      

> `@Repository`    
> 직접적 DB 연동    

```java
// ***************************************
// [ModelAndView 객체] 에 [게시판 목록 검색 결과]를 저장하기
// ***************************************
mav.addObject("boardList", boardList);


mav.addObject("getBoardListCount", getBoardListCount);
```
> 연동결과를 ModelAndView 객체 에 저장하기.  

#

`BoardDAO.java` 에서,  

```java
// ******************************************************
// [검색한 게시판 목록 총개수] 리턴하는 메소드 선언
// ******************************************************
int getBoardListCount(BoardSearchDTO boardSearchDTO);

```

#

`BoardServiceImpl.java`

```java
// ******************************************************
// [검색한 게시판 목록 개수] 리턴하는 메소드 선언
// ******************************************************
public int getBoardListCount(BoardSearchDTO boardSearchDTO){

    // -------------------------------------------
    // [SqlSessionTemplate 객체]의 selectOne(~,~) 를 호출하여 [1개 게시판 글 정보] 얻기
    // selectOne 은 1행 m열의 select 결과를 얻을 때 사용하는 메소드이다.  
    // -------------------------------------------
    int getBoardListCount = this.sqlSession.selectOne(
        //-----------------------------------------------
        // 실행할 SQL 구문의 위치를 지정하기.
        // 실행할 SQL 구문의 위치 문자열 패턴은 아래와 같다.
        // xml 파일 중에 "mapper태그의namespace명.mapper태그내부의호출할SQL구문소유한태그id값"
        //-----------------------------------------------
        "com.naver.erp.BoardDAO.getBoardListCount"	// 실행할 SQL 구문의 위치 지정
        //-----------------------------------------------
        // 실행할 SQL구문에서 사용할 데이터 지정하기
        //-----------------------------------------------
        , boardSearchDTO
    );                       

    // -------------------------------------------
    // [1개 게시판 글 정보] 리턴하기
    // -------------------------------------------
    
    System.out.println("BoardDAOImpl 게시판 목록 검색개수 확인 =>" + getBoardListCount);
    
    return getBoardListCount;

}
```

#

`mapper_board.xml`   

```xml
<select id="getBoardListCount" parameterType="com.naver.erp.BoardDTO" resultType="int">
    select
        count(*)
    from     
          board
    where 
        1=1
        <!-- ============================================================== -->
        <!-- 만약 키워드가 null 이 아니고 길이가 0보다 크면 where 절에 참여하기 -->
        <!-- ============================================================== -->
        <if test="keyword1!=null and keyword1.length()>0">
        and (
            upper(subject) like upper('%${keyword1}%')
            or
            upper(content) like upper('%${keyword1}%')
            or
            upper(writer) like upper('%${keyword1}%')
            or
            upper(email) like upper('%${keyword1}%')
            or
            to_char(reg_date, 'YYYY-MM-DD') like '%${keyword1}%'
            or
            to_char(reg_date, 'YYYYMMDD') like '%${keyword1}%'
            or
            to_char(reg_date, 'YYYY/MM/DD') like '%${keyword1}%'
            or
            to_char(reg_date, 'YYYY,MM,DD') like '%${keyword1}%'
        )
        </if>

</select>
```

#

`boardList.jsp`  

```java
  ,success  : function( responseHTML ){
      // ----------------------------------------------------------
      // 매개변수 responseHTML 로 들어온 검색 결과물 html 소스 문자열에서 
      // class=searchResult 를 가진 태그 내부의 [검색 결과물 html 소스]를 얻어서
      // 아래 현 화면의 html 소스중에 class=searchResult 를 가진 태그 내부에 덮어씌우기  
      // ----------------------------------------------------------
      var html = $(responseHTML).find(".searchResult").html();

      $(".searchResult").html(html);

      // ----------------------------------------------------------
      // 매개변수 responseHTML 로 들어온 검색 결과물 html 소스 문자열에서 
      // class=boardListAllCnt 를 가진 태그 내부의 [총개수 문자열]을 얻어서
      // 아래 현 화면의 html 소스중에 class=boardListAllCnt 를 가진 태그 내부에 덮어씌우기  
      // ----------------------------------------------------------
      var cnt = $(responseHTML).find(".boardListAllCnt").text();

      $(".boardListAllCnt").text(cnt);



  
  }

  // 위 코드는 아래와 같다. 다른 형식.    

  $(".searchResult").html(
    $(responseHTML).find(".searchResult").html()
  );


  $(".boardListAllCnt").text(
    $(responseHTML).find(".boardListAllCnt").text()
  );


  // ---------------------------------------------------





  // ---------------- 아래는 테이블 태그 위쪽에, 작성.

  <div class="boardListAllCnt" style="height: 10px;">검색 개수 : <% out.print( (int)request.getAttribute("getBoardListCount") );%> 개</div> <br><!-- 공백조절용 div 태그 -->

  // 아래와 같이해도 같은 결과가 나온다.  위 코드 중 택 1

  <div class="boardListAllCnt" style="height: 10px;">총 <%=(Integer)request.getAttribute("getBoardListCount")%>개</div> <br><!-- 공백조절용 div 태그 -->


```

#

----
### `10:30~`

### # 게시판 페이징 처리.  

```
-------------------------------------------------------
게시판 검색 결과 개수                    => 109개
-------------------------------------------------------
한 화면에 보여주고 싶은 게시판 개수       => 10개
-------------------------------------------------------
한 화면에 보여주고싶은 페이지 번호 개수   => 10개
-------------------------------------------------------
페이지 번호 총개수                      => 109/10 => 10.9 => 11
-------------------------------------------------------
1 페이지에 보이고 싶은 게시판 목록은 검색 결과물에서 몇번째행에서 몇번행까지 인가?  1행 ~ 10행
-------------------------------------------------------
2 페이지에 보이고 싶은 게시판 목록은 검색 결과물에서 몇번째행에서 몇번행까지 인가?  11행 ~ 20행
-------------------------------------------------------

```

> ![페이징처리 설명](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210831%201110_%ED%8E%98%EC%9D%B4%EC%A7%95%EC%84%A4%EB%AA%85_.png)      

> 페이징 처리하고 페이징 처리 목록도 페이징 처리 되어야한다.    
> 100개를 10개씩 끊으면 페이징 처리 목록은 10개지만,   
> 수가 많아져서 1000개면, 페이징 처리 목록번호도 100개로 전부 나열할수 없기 때문.  

> ![페이징처리 설명2](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210831%201115_%ED%8E%98%EC%9D%B4%EC%A7%95%EC%B2%98%EB%A6%AC%EC%84%A4%EB%AA%852_.png)     

----
### `11:30~`

```

각 변수명 기억하기.  (입) 입사시험   
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
totCnt         => 검색된 총 결과물 개수  

rowCntPerPage  => 페이지당 보여줄 행의 개수

selectPageNo   => 선택한 페이지 번호

beginRowNo     => 검색된 총 결과물에서 가져올 범위의 시작행 

endRowNo       => 검색된 총 결과물에서 가져올 범위의 끝행
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
totCnt         => 109
rowCntPerPage  => 10
----------------------------------
selectPageNo   => 1
beginRowNo     => 1 
endRowNo       => 10
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
totCnt         => 109
rowCntPerPage  => 10
----------------------------------
selectPageNo   => 2
beginRowNo     => 11
endRowNo       => 20
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
totCnt         => 109
rowCntPerPage  => 10
----------------------------------
selectPageNo   => 4
beginRowNo     => ( (4 * 10) - 10  )+ 1   = 31
endRowNo       => 4 * 10 = 40  
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
totCnt         => 109
rowCntPerPage  => 10
----------------------------------
selectPageNo   => 11
beginRowNo     => ( (11 * 10) - 10  )+ 1 = 101
endRowNo       => 11 * 10  = 110(x) => 109(o)
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm

(입) 입사시험
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
공식 => [페이지당 보여줄 행의 개수], [선택페이지번호], [총개수]로 
        검색 결과물의 [시작행 번호]와 검색 결과물의 [끝행 번호]를 구하는 공식.
        단, 변수는 아래와 같다.  
---------------------------------------------------------------
        totCnt         => 검색된 총 결과물 개수  
        rowCntPerPage  => 페이지당 보여줄 행의 개수
        selectPageNo   => 선택한 페이지 번호
        beginRowNo     => 검색된 총 결과물에서 가져올 범위의 시작행 
        endRowNo       => 검색된 총 결과물에서 가져올 범위의 끝행
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
if( totCnt >0 ){
    int endRowNO = selectPageNO * rowCntPerPage;
    int beginRowNo = endRowNO - rowCntPerPage + 1;
    if( endRowNO>totCnt){
      endRowNO = totCnt;
    }
}
----------------------------------
if( totCnt >0 ){
    int beginRowNo = (selectPageNO * rowCntPerPage) - rowCntPerPage + 1
    int endRowNO = beginRowNo + rowCntPerPage -1;
    if( endRowNO>totCnt){
      endRowNO = totCnt;
    }
}

```
> 페이지 번호의 수학적 관계를 알아야 한다.  

> 끝행은 10을 곱해나가지만 총 개수를 넘어가면 총개수로 표현해야 한다.  

> ![페이징 수학적 관계](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210831%201155_%ED%8E%98%EC%9D%B4%EC%A7%95_%EC%88%98%ED%95%99%EC%A0%81%EA%B4%80%EA%B3%84_.png)      

> 마지막 페이지번호는 총개수보다 큰지 작은지 조건문으로 판단하고,  
> 총개수보다 크면 총개수로 표기하는식으로 해야 한다.  

> ![페이징 수학적 관계2](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210831%201201_%ED%8E%98%EC%9D%B4%EC%A7%95_%EC%88%98%ED%95%99%EC%A0%81%EA%B4%80%EA%B3%84_2_.png)    


페이지 번호도 끊어서 보여주어야 한다.  
> 검색 결과가 1000개 넘는 등 수가 많아지면 페이지 번호도 끊어서 보여주는것이 좋다.  

> 페이지 번호의 최소, 최대 구해서 표현해야 한다.  

#

----
### `12:30~`

모든 프로젝트 검색결과물,  페이징 처리.  

```
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
공식 => [총개수], [선택된 페이지 번호], [한 화면에 보여지는 페이지번호 개수]로 
        [현재 화면에 보여지는 페이지번호의 최소 번호]와
        [현재 화면에 보여지는 페이지번호의 최대 번호]를 구하는 공식
        단, 변수는 아래와 같다.  
---------------------------------------------------------------
        totCnt             => 검색된 총 결과물 개수
        selectPageNo       => 선택한 페이지 번호  
        pageNoCntPerPage   => 페이지당 보여줄 번호의 개수
        pageMinNo          => 현재화면에 보여지는 페이지 번호의 최소 페이지 번호
        pageMaxNo          => 현재화면에 보여지는 페이지 번호의 최대 페이지 번호
mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm

totCnt             => 109
selectPageNo       => 1
pageNoCntPerPage   => 10
pageMinNo          => 1
pageMaxNo          => 10


totCnt             => 1000
selectPageNo       => 1
pageNoCntPerPage   => 10
pageMinNo          => 1
pageMaxNo          => 10

totCnt             => 1000
selectPageNo       => 11
pageNoCntPerPage   => 10
pageMinNo          => 11
pageMaxNo          => 20

totCnt             => 1000
selectPageNo       => 21
pageNoCntPerPage   => 10
pageMinNo          => 11
pageMaxNo          => 20




if( totCnt >0 ){
    int pageMinNo
    int pageMaxNo = pageNoCntPerPage
}





```
> ![페이지 번호 페이징](https://github.com/SungWoo0315/study-repository/blob/main/image-save/20210831%201241_%ED%8E%98%EC%9D%B4%EC%A7%80%EB%B2%88%ED%98%B8%20%ED%8E%98%EC%9D%B4%EC%A7%95_.png)  



















----
### `13:20~`

  - 점심시간.

---
---

## # 오후수업

---
### `14:30~`










---
### `15:30~`









----
### `16:30~`








----
### `17:30~`








----
### `18:30~`

면접준비,    

양복, 신발,   

#


